<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>json on Alfred Nutile</title><link>https://alfrednutile.info/tags/json/</link><description>Recent content in json on Alfred Nutile</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Thu, 03 Nov 2016 00:00:00 +0000</lastBuildDate><atom:link href="https://alfrednutile.info/tags/json/index.xml" rel="self" type="application/rss+xml"/><item><title>Laravel and Casting 'JSON_UNESCAPED_UNICODE' Data</title><link>https://alfrednutile.info/posts/196/</link><pubDate>Thu, 03 Nov 2016 00:00:00 +0000</pubDate><guid>https://alfrednutile.info/posts/196/</guid><description>&lt;p>Had a interesting issue with Laravel and the &lt;a href="https://laravel.com/docs/5.2/eloquent-mutators">cast feature&lt;/a>&lt;/p>
&lt;p>Basically a Chinese set of characters would be converted to their unicode counterpart &lt;a href="http://php.net/manual/en/json.constants.php">http://php.net/manual/en/json.constants.php&lt;/a>&lt;/p>
&lt;p>So saving &amp;ldquo;你好，世界&amp;rdquo; would become &amp;ldquo;\u4f60\u597d\uff0c\u4e16\u754c&amp;rdquo; in the database.&lt;/p>
&lt;p>Making it hard to search for &amp;ldquo;你好，世界&amp;rdquo;&lt;/p>
&lt;p>But I just wanted this data as it was, so later I could query the data and interact with it in it&amp;rsquo;s default character state.&lt;/p>
&lt;p>Digging into the Model class &lt;code>vendor/laravel/framework/src/Illuminate/Database/Eloquent/Model.php:3044&lt;/code> I found that this method would &lt;code>json_encode&lt;/code> but with no options.&lt;/p>
&lt;p>So on my model I had to override that&lt;/p>
&lt;pre>&lt;code> protected function asJson($value)
{
/**
* Alter Cast
* Default is altering unicode
*/
return json_encode($value, JSON_UNESCAPED_UNICODE);
}
&lt;/code>&lt;/pre>&lt;p>And now &amp;ldquo;你好，世界&amp;rdquo; would save that way to the database and not &amp;ldquo;\u4f60\u597d\uff0c\u4e16\u754c&amp;rdquo;&lt;/p></description><tags>laravel, json, note2self</tags></item></channel></rss>