<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>json on Alfred Nutile</title><link>https://alfrednutile.info/tags/json/</link><description>Recent content in json on Alfred Nutile</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Thu, 03 Nov 2016 00:00:00 +0000</lastBuildDate><atom:link href="https://alfrednutile.info/tags/json/index.xml" rel="self" type="application/rss+xml"/><item><title>Laravel and Casting 'JSON_UNESCAPED_UNICODE' Data</title><link>https://alfrednutile.info/posts/196/</link><pubDate>Thu, 03 Nov 2016 00:00:00 +0000</pubDate><guid>https://alfrednutile.info/posts/196/</guid><description><p>Had a interesting issue with Laravel and the<a href="https://laravel.com/docs/5.2/eloquent-mutators">cast feature</a></p><p>Basically a Chinese set of characters would be converted to their unicode counterpart<a href="http://php.net/manual/en/json.constants.php">http://php.net/manual/en/json.constants.php</a></p><p>So saving &ldquo;你好，世界&rdquo; would become &ldquo;\u4f60\u597d\uff0c\u4e16\u754c&rdquo; in the database.</p><p>Making it hard to search for &ldquo;你好，世界&rdquo;</p><p>But I just wanted this data as it was, so later I could query the data and interact with it in it&rsquo;s default character state.</p><p>Digging into the Model class<code>vendor/laravel/framework/src/Illuminate/Database/Eloquent/Model.php:3044</code> I found that this method would<code>json_encode</code> but with no options.</p><p>So on my model I had to override that</p><pre><code> protected function asJson($value)
{
/**
* Alter Cast
* Default is altering unicode
*/
return json_encode($value, JSON_UNESCAPED_UNICODE);
}<p/></pre><p>And now “你好，世界” would save that way to the database and not “\u4f60\u597d\uff0c\u4e16\u754c”</p></p></description><tags>laravel, json, note2self</tags></item></channel></rss>